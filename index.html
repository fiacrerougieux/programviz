<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Competencies Dashboard</title>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            max-width: 1400px;
            margin: 0 auto;
        }
        #controls {
            margin-bottom: 20px;
            background-color: white;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
            display: flex;
            gap: 30px;
        }
        .button-group {
            display: flex;
            flex-direction: column;
            width: fit-content;
            min-width: 200px;
        }
        #plot-container {
            width: 100%;
            height: 1000px;
            background-color: white;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
            border-radius: 8px;
        }
        .section-title {
            margin: 0 0 10px 0;
            font-size: 1.1em;
            color: #333;
        }
        .switch-button {
            padding: 10px 20px;
            font-size: 16px;
            cursor: pointer;
            border: none;
            border-radius: 4px;
            margin: 0 5px;
            transition: background-color 0.3s;
        }
        .switch-button.active {
            background-color: #4CAF50;
            color: white;
        }
        .switch-button:not(.active) {
            background-color: #f0f0f0;
            color: #333;
        }
    </style>
</head>
<body>
    <div class="container">
        <div id="controls">
            <div class="button-group">
                <h3 class="section-title">Competencies</h3>
                <button id="radarBtn" class="switch-button">What to scaffold?</button>
                <button id="heatmapCumBtn" class="switch-button">When to scaffold?</button>
                <button id="heatmapNonCumBtn" class="switch-button active">Where to scaffold?</button>
            </div>
            <div class="button-group">
                <h3 class="section-title">SDGs</h3>
                <button id="sdgRadarBtn" class="switch-button">What to scaffold?</button>
                <button id="sdgCumBtn" class="switch-button">When to scaffold?</button>
                <button id="sdgBtn" class="switch-button">Where to scaffold?</button>
            </div>
            <div class="button-group">
                <h3 class="section-title">Prerequisites</h3>
                <button id="sankeyBtn" class="switch-button">What are the prerequisites?</button>
            </div>
        </div>
        <div id="plot-container"></div>
    </div>

    <script>
        const competencies = {
            "1.1": "Science Fundamentals",
            "1.2": "Math Foundations",
            "1.3": "Specialist Knowledge",
            "1.4": "Research Directions",
            "1.5": "Design Practice",
            "1.6": "Sustainable Practice",
            "2.1": "Problem Solving",
            "2.2": "Tech Application",
            "2.3": "Design Processes",
            "2.4": "Project Management",
            "3.1": "Ethical Conduct",
            "3.2": "Effective Communication",
            "3.3": "Creative Mindset",
            "3.4": "Info Management",
            "3.5": "Self Management",
            "3.6": "Team Leadership"
        };

        let percentage_matrix;
        let cumulative_percentage_matrix;
        let x_labels;
        let combined_competency_labels;
        let shapes;
        let annotations;
        let filtered_courses;

        fetch('competencies_SPREE.json')
            .then(response => response.json())
            .then(course_competencies => {
                fetch('bachelor_RE_RE_Systems_Strand.json')
                    .then(response => response.json())
                    .then(course_schedule => {
                        processData(course_competencies, course_schedule);
                        createHeatmap(false);
                    });
            });

        function processData(course_competencies, course_schedule) {
            const courses = [];
            Object.keys(course_schedule).sort().forEach(year => {
                Object.keys(course_schedule[year]).sort().forEach(term => {
                    courses.push(...course_schedule[year][term]);
                });
            });

            const unwanted_courses = new Set(["DISP", "GEN ED", "ELECTIVE", "ELEC3115", "ELEC4122"]);
            filtered_courses = courses.filter(course => !unwanted_courses.has(course));

            const detailed_competency_ids = Object.keys(competencies).filter(comp_id => comp_id.includes('.'));
            const matrix = Array(detailed_competency_ids.length).fill().map(() => Array(filtered_courses.length).fill(0));

            Object.entries(course_competencies).forEach(([comp_id, sub_comps]) => {
                Object.entries(sub_comps).forEach(([sub_comp, courses_dict]) => {
                    if (detailed_competency_ids.includes(sub_comp)) {
                        Object.entries(courses_dict).forEach(([course, clos]) => {
                            if (filtered_courses.includes(course)) {
                                const row_index = detailed_competency_ids.indexOf(sub_comp);
                                const col_index = filtered_courses.indexOf(course);
                                matrix[row_index][col_index] += clos.length;
                            }
                        });
                    }
                });
            });

            const total_clos_per_course = matrix.reduce((acc, row) => {
                row.forEach((val, i) => acc[i] = (acc[i] || 0) + val);
                return acc;
            }, []);

            percentage_matrix = matrix.map(row => 
                row.map((val, i) => total_clos_per_course[i] ? (val / total_clos_per_course[i]) * 100 : 0)
            );

            cumulative_percentage_matrix = percentage_matrix.map(row => {
                let sum = 0;
                return row.map(val => {
                    sum += val;
                    return Math.min(sum, 100);
                });
            });

            shapes = [];
            annotations = [];
            const bar_courses = ["ELEC1111", "MATH2069", "ELEC2911"];
            const years = ["Year 1", "Year 2", "Year 3", "Year 4"];

            const bar_positions = [];
            bar_courses.forEach(bar_course => {
                if (filtered_courses.includes(bar_course)) {
                    const idx = filtered_courses.indexOf(bar_course);
                    bar_positions.push(idx + 0.5);
                    shapes.push({
                        type: "line",
                        x0: idx + 0.5,
                        y0: -0.5,
                        x1: idx + 0.5,
                        y1: detailed_competency_ids.length - 0.5,
                        line: { color: "black", width: 2 }
                    });
                }
            });

            const all_positions = [-0.5, ...bar_positions, filtered_courses.length - 0.5];
            years.forEach((year, i) => {
                annotations.push({
                    x: (all_positions[i] + all_positions[i + 1]) / 2,
                    y: 1.05,
                    yref: "paper",
                    text: year,
                    showarrow: false,
                    font: { size: 14, color: "black" }
                });
            });

            combined_competency_labels = detailed_competency_ids.map(comp_id => 
                `${comp_id} - ${competencies[comp_id]}`
            );

            const category_counters = {
                Math: 0,
                Physics: 0,
                Specialisation: 0,
                Design: 0,
                Other: 0
            };

            x_labels = filtered_courses.map(course => {
                let category = "Other";
                if (course.startsWith("MATH")) category = "Math";
                else if (course.startsWith("PHYS")) category = "Physics";
                else if (course.startsWith("ENGG") || course.startsWith("SOLA") || 
                         course.startsWith("MMAN") || course.startsWith("ELEC")) category = "Specialisation";
                else if (course.startsWith("DESN")) category = "Design";
                
                category_counters[category]++;
                return `${category} (${category_counters[category]})`;
            });
        }

        function createHeatmap(isCumulative) {
            const data = [{
                type: "heatmap",
                z: isCumulative ? cumulative_percentage_matrix : percentage_matrix,
                x: x_labels,
                y: combined_competency_labels,
                colorscale: 'YlOrRd',
                reversescale: true,
                zmin: 0,
                zmax: isCumulative ? 100 : 100,
                colorbar: { title: isCumulative ? "Cumulative CLOs (%)" : "Percentage of CLOs" }
            }];

            const layout = {
                xaxis: {
                    title: "Courses",
                    tickmode: 'array',
                    tickvals: Array.from({length: x_labels.length}, (_, i) => i),
                    ticktext: x_labels,
                    tickangle: 45
                },
                yaxis: {
                    title: "Competencies",
                    tickmode: 'array',
                    tickvals: Array.from({length: combined_competency_labels.length}, (_, i) => i),
                    ticktext: combined_competency_labels
                },
                height: 1000,
                shapes: shapes,
                annotations: annotations,
                margin: {
                    l: 200,
                    r: 50,
                    t: 50,
                    b: 100
                }
            };

            Plotly.newPlot('plot-container', data, layout);
        }

        function createRadarPlot() {
            const bar_courses = ["ELEC1111", "MATH2069", "ELEC2911", "SOLA4953"].reverse();
            const course_labels = ["Year 1", "Year 2", "Year 3", "Year 4"].reverse();
            const colors = [
                'rgba(254, 204, 92, 0.30)',
                'rgba(253, 141, 60, 0.25)',
                'rgba(240, 59, 32, 0.20)',
                'rgba(189, 0, 38, 0.15)'
            ];

            const radar_data = [];
            for (let i = 0; i < bar_courses.length; i++) {
                const course = bar_courses[i];
                if (filtered_courses.includes(course)) {
                    const idx = filtered_courses.indexOf(course);
                    const r_values = [...cumulative_percentage_matrix.map(row => row[idx])];
                    r_values.push(r_values[0]); // Close the loop
                    const theta_values = [...combined_competency_labels, combined_competency_labels[0]];

                    radar_data.push({
                        type: 'scatterpolar',
                        r: r_values,
                        theta: theta_values,
                        fill: 'toself',
                        fillcolor: colors[i],
                        name: course_labels[i],
                        line: {
                            shape: 'spline',
                            color: colors[i].replace(/[0-9.]+\)$/, '1.0)')
                        }
                    });
                }
            }

            const layout = {
                polar: {
                    radialaxis: {
                        visible: true,
                        range: [0, 100],
                        tickvals: [0, 25, 50, 75, 100],
                        ticktext: ['0%', '25%', '50%', '75%', '100%'],
                        tickfont: { size: 12 },
                        gridcolor: 'lightgrey',
                        linecolor: 'grey'
                    },
                    angularaxis: {
                        tickfont: { size: 12 },
                        gridcolor: 'lightgrey',
                        linecolor: 'grey'
                    },
                    bgcolor: 'white'
                },
                showlegend: true,
                legend: {
                    font: { size: 12, family: 'Arial, sans-serif' },
                    bgcolor: 'white',
                    bordercolor: 'white',
                    borderwidth: 0,
                    x: 1.1,
                    y: 1,
                    xanchor: 'left',
                    yanchor: 'top'
                },
                width: 1100,
                height: 800
            };

            Plotly.newPlot('plot-container', radar_data, layout);
        }

            async function loadCourseData() {
                try {
                    const response = await fetch('Renewable Energy Engineering_SOLAD1.json');
                    const courseData = await response.json();
                    return courseData;
                } catch (error) {
                    console.error('Error loading the course data:', error);
                    return null;
                }
            }

            function createSankeyData(courses) {
                // Create a set of all unique courses (including prerequisites)
                var allCourses = new Set(Object.keys(courses));
                for (var course in courses) {
                    courses[course].prerequisites.forEach(function(prereq) {
                        allCourses.add(prereq);
                    });
                }

                // Create nodes for each course
                var nodes = Array.from(allCourses);

                var edges = [];
                for (var course in courses) {
                    if (courses[course].prerequisites.length > 0) {
                        courses[course].prerequisites.forEach(function(prereq) {
                            edges.push([prereq, course]);
                        });
                    }
                }

                // Define a color map based on the first digit of the course code
                var colorMap = {
                    '1': 'red',
                    '2': 'blue',
                    '3': 'green',
                    '4': 'purple',
                    '5': 'orange',
                    '6': 'cyan',
                    '8': 'lime',
                    '9': 'pink'
                };

                // Assign colors to nodes based on the first digit of the course code
                var nodeColors = nodes.map(function(course) {
                    var level = course[4];
                    return colorMap[level] || 'gray';
                });

                var data = [{
                    type: "sankey",
                    orientation: "h",
                    node: {
                        pad: 10,
                        thickness: 15,
                        line: {
                            color: "black",
                            width: 0.5
                        },
                        label: nodes,
                        color: nodeColors,
                        value: nodes.map(function(course) {
                            return courses[course] && courses[course].prerequisites.length === 0 ? 1 : 0;
                        }),
                        arrangement: 'snap',
                        font: {
                            size: 8
                        }
                    },
                    link: {
                        source: edges.map(function(e) { return nodes.indexOf(e[0]); }),
                        target: edges.map(function(e) { return nodes.indexOf(e[1]); }),
                        value: edges.map(function() { return 1; }),
                    }
                }];

                // Create legend traces for each level
                var legendTraces = [];
                for (var level in colorMap) {
                    legendTraces.push({
                        x: [null],
                        y: [null],
                        mode: 'markers',
                        marker: {
                            symbol: 'square',
                            size: 12,
                            color: colorMap[level],
                            line: {
                                width: 1,
                                color: 'black'
                            }
                        },
                        name: 'Level ' + level,
                        legendgroup: 'Level ' + level,
                        showlegend: true
                    });
                }

                return data.concat(legendTraces);
            }

            function createSankeyLayout() {
                return {
                    xaxis: {
                        showticklabels: false,
                        showgrid: false,
                        zeroline: false
                    },
                    yaxis: {
                        showticklabels: false,
                        showgrid: false,
                        zeroline: false
                    },
                    font: {
                        size: 14
                    },
                    width: 1200,
                    height: 1000,
                    legend: {
                        x: 1.0,
                        y: 1.0,
                        bgcolor: 'rgba(255, 255, 255, 0.8)',
                        bordercolor: 'rgba(255, 255, 255, 0.8)',
                        font: {
                            size: 14
                        }
                    }
                };
            }

            async function createSankeyDiagram() {
                const courseData = await loadCourseData();
                if (courseData) {
                    var data = createSankeyData(courseData);
                    var layout = createSankeyLayout();
                    Plotly.newPlot('plot-container', data, layout);
                }
            }



            async function createSdgHeatmap() {
                try {
                    const response = await fetch('SDG_SPREE.json');
                    const sdgMapping = await response.json();

                    const sdgs = {
                        "1": "No Poverty",
                        "2": "Zero Hunger",
                        "3": "Good Health and Well-being",
                        "4": "Quality Education",
                        "5": "Gender Equality",
                        "6": "Clean Water and Sanitation",
                        "7": "Affordable and Clean Energy",
                        "8": "Decent Work and Economic Growth",
                        "9": "Industry, Innovation and Infrastructure",
                        "10": "Reduced Inequalities",
                        "11": "Sustainable Cities and Communities",
                        "12": "Responsible Consumption and Production",
                        "13": "Climate Action",
                        "14": "Life Below Water",
                        "15": "Life on Land",
                        "16": "Peace, Justice and Strong Institutions",
                        "17": "Partnerships for the Goals"
                    };

                    const filteredCourses = Object.keys(sdgMapping);
                    const matrix = Array(Object.keys(sdgs).length).fill().map(() => 
                        Array(filteredCourses.length).fill(0)
                    );

                    filteredCourses.forEach((course, courseIdx) => {
                        Object.keys(sdgMapping[course]).forEach(sdgId => {
                            if (sdgs[sdgId]) {
                                const rowIndex = parseInt(sdgId) - 1;
                                matrix[rowIndex][courseIdx] = sdgMapping[course][sdgId].length;
                            }
                        });
                    });

                    const totalSdgsPerCourse = matrix.reduce((acc, row) => {
                        row.forEach((val, idx) => {
                            acc[idx] = (acc[idx] || 0) + val;
                        });
                        return acc;
                    }, []);

                    const percentageMatrix = matrix.map(row =>
                        row.map((val, idx) => 
                            totalSdgsPerCourse[idx] ? (val / totalSdgsPerCourse[idx]) * 100 : 0
                        )
                    );

                    const combinedSdgLabels = Object.entries(sdgs).map(([id, name]) => 
                        `SDG ${id} - ${name}`
                    );

                    const data = [{
                        z: percentageMatrix,
                        x: filteredCourses,
                        y: combinedSdgLabels,
                        type: 'heatmap',
                        colorscale: 'YlOrRd',
                        reversescale: true,
                        zmin: 0,
                        zmax: 100,
                        colorbar: {
                            title: 'Percentage of SDGs Addressed'
                        }
                    }];

                    const layout = {
                        xaxis: {
                            title: 'Courses',
                            tickangle: 45
                        },
                        yaxis: {
                            title: 'Sustainable Development Goals'
                        },
                        height: 1000,
                        margin: {
                            l: 250,
                            r: 50,
                            b: 100,
                            t: 50
                        }
                    };

                    Plotly.newPlot('plot-container', data, layout);

                } catch (error) {
                    console.error('Error loading or processing SDG data:', error);
                }
            }

            async function createCumulativeSdgHeatmap() {
                try {
                    const response = await fetch('SDG_SPREE.json');
                    const sdgMapping = await response.json();

                    const sdgs = {
                        "1": "No Poverty",
                        "2": "Zero Hunger",
                        "3": "Good Health and Well-being",
                        "4": "Quality Education",
                        "5": "Gender Equality",
                        "6": "Clean Water and Sanitation",
                        "7": "Affordable and Clean Energy",
                        "8": "Decent Work and Economic Growth",
                        "9": "Industry, Innovation and Infrastructure",
                        "10": "Reduced Inequalities",
                        "11": "Sustainable Cities and Communities",
                        "12": "Responsible Consumption and Production",
                        "13": "Climate Action",
                        "14": "Life Below Water",
                        "15": "Life on Land",
                        "16": "Peace, Justice and Strong Institutions",
                        "17": "Partnerships for the Goals"
                    };

                    const yearMarkers = {
                        "ELEC1111": "Year 1",
                        "MATH2069": "Year 2",
                        "ELEC2911": "Year 3"
                    };

                    const filteredCourses = Object.keys(sdgMapping);
                    const matrix = Array(Object.keys(sdgs).length).fill().map(() => 
                        Array(filteredCourses.length).fill(0)
                    );

                    filteredCourses.forEach((course, courseIdx) => {
                        Object.keys(sdgMapping[course]).forEach(sdgId => {
                            if (sdgs[sdgId]) {
                                const rowIndex = parseInt(sdgId) - 1;
                                matrix[rowIndex][courseIdx] = sdgMapping[course][sdgId].length;
                            }
                        });
                    });

                    const totalSdgsPerCourse = matrix.reduce((acc, row) => {
                        row.forEach((val, idx) => {
                            acc[idx] = (acc[idx] || 0) + val;
                        });
                        return acc;
                    }, []);

                    const percentageMatrix = matrix.map(row =>
                        row.map((val, idx) => 
                            totalSdgsPerCourse[idx] ? (val / totalSdgsPerCourse[idx]) * 100 : 0
                        )
                    );

                    const cumulativeMatrix = percentageMatrix.map(row => {
                        const cumRow = [];
                        let sum = 0;
                        row.forEach(val => {
                            sum += val;
                            cumRow.push(sum);
                        });
                        return cumRow;
                    });

                    const courseLabels = filteredCourses.map(course => {
                        let category = "Other";
                        if (course.startsWith("MATH")) category = "Math";
                        else if (course.startsWith("PHYS")) category = "Physics";
                        else if (course.startsWith("ENGG") || course.startsWith("SOLA") || 
                                course.startsWith("MMAN") || course.startsWith("ELEC")) category = "Specialisation";
                        else if (course.startsWith("DESN")) category = "Design";
                        return `${category} (${course})`;
                    });

                    const shapes = [];
                    const annotations = [];
                    const yearPositions = [-0.5];

                    filteredCourses.forEach((course, idx) => {
                        if (yearMarkers[course]) {
                            shapes.push({
                                type: "line",
                                x0: idx + 0.5,
                                y0: -0.5,
                                x1: idx + 0.5,
                                y1: Object.keys(sdgs).length - 0.5,
                                line: { color: "black", width: 2 }
                            });
                            yearPositions.push(idx + 0.5);
                        }
                    });
                    yearPositions.push(filteredCourses.length - 0.5);

                    ["Year 1", "Year 2", "Year 3", "Year 4"].forEach((year, idx) => {
                        annotations.push({
                            x: (yearPositions[idx] + yearPositions[idx + 1]) / 2,
                            y: 1.05,
                            yref: "paper",
                            text: year,
                            showarrow: false,
                            font: { size: 14, color: "black" }
                        });
                    });

                    const combinedSdgLabels = Object.entries(sdgs).map(([id, name]) => 
                        `SDG ${id} - ${name}`
                    );

                    const data = [{
                        z: cumulativeMatrix,
                        x: courseLabels,
                        y: combinedSdgLabels,
                        type: 'heatmap',
                        colorscale: 'YlOrRd',
                        reversescale: true,
                        zmin: 0,
                        zmax: 400,
                        colorbar: {
                            title: 'Cumulative Percentage of SDGs Addressed'
                        }
                    }];

                    const layout = {
                        xaxis: {
                            title: 'Courses',
                            tickangle: 45
                        },
                        yaxis: {
                            title: 'Sustainable Development Goals'
                        },
                        height: 1000,
                        margin: {
                            l: 250,
                            r: 50,
                            b: 100,
                            t: 50
                        },
                        shapes: shapes,
                        annotations: annotations
                    };

                    Plotly.newPlot('plot-container', data, layout);

                } catch (error) {
                    console.error('Error loading or processing SDG data:', error);
                }
            }


            async function createSdgRadarPlot() {
                try {
                    const response = await fetch('SDG_SPREE.json');
                    const sdgMapping = await response.json();

                    const bar_courses = ["ELEC1111", "MATH2069", "ELEC2911", "SOLA4953"].reverse();
                    const course_labels = ["Year 1", "Year 2", "Year 3", "Year 4"].reverse();
                    const colors = [
                        'rgba(254, 204, 92, 0.30)',
                        'rgba(253, 141, 60, 0.25)',
                        'rgba(240, 59, 32, 0.20)',
                        'rgba(189, 0, 38, 0.15)'
                    ];

                    const sdg_labels = [
                        "SDG 1 - No Poverty",
                        "SDG 2 - Zero Hunger",
                        "SDG 3 - Good Health and Well-being",
                        "SDG 4 - Quality Education",
                        "SDG 5 - Gender Equality",
                        "SDG 6 - Clean Water and Sanitation",
                        "SDG 7 - Affordable and Clean Energy",
                        "SDG 8 - Decent Work and Economic Growth",
                        "SDG 9 - Industry, Innovation and Infrastructure",
                        "SDG 10 - Reduced Inequalities",
                        "SDG 11 - Sustainable Cities and Communities",
                        "SDG 12 - Responsible Consumption and Production",
                        "SDG 13 - Climate Action",
                        "SDG 14 - Life Below Water",
                        "SDG 15 - Life on Land",
                        "SDG 16 - Peace, Justice and Strong Institutions",
                        "SDG 17 - Partnerships for the Goals"
                    ];

                    const radar_data = [];
                    
                    // Process each milestone course
                    for (let i = 0; i < bar_courses.length; i++) {
                        const course = bar_courses[i];
                        const courseIndex = filtered_courses.indexOf(course);
                        
                        console.log(`Processing ${course} at index ${courseIndex}`);
                        
                        if (courseIndex !== -1) {
                            // Initialize array for cumulative SDG counts
                            const sdgCounts = Array(17).fill(0);
                            
                            // Accumulate SDGs up to this course
                            for (let j = 0; j <= courseIndex; j++) {
                                const currentCourse = filtered_courses[j];
                                // Find the full course name in sdgMapping
                                const fullCourseName = Object.keys(sdgMapping).find(key => key.startsWith(currentCourse));
                                const courseSDGs = fullCourseName ? sdgMapping[fullCourseName] : null;
                                
                                console.log(`Checking SDGs for ${currentCourse} (${fullCourseName}):`, courseSDGs);
                                
                                if (courseSDGs) {
                                    Object.entries(courseSDGs).forEach(([sdgId, items]) => {
                                        const sdgIndex = parseInt(sdgId) - 1;
                                        if (sdgIndex >= 0 && sdgIndex < 17) {
                                            sdgCounts[sdgIndex] += items.length;
                                        }
                                    });
                                }
                            }

                            console.log(`SDG counts for ${course}:`, sdgCounts);

                            // Convert to percentages
                            const maxCount = Math.max(...sdgCounts, 1);
                            const percentages = sdgCounts.map(count => (count / maxCount) * 100);
                            
                            console.log(`Percentages for ${course}:`, percentages);

                            // Close the loop
                            percentages.push(percentages[0]);

                            radar_data.push({
                                type: 'scatterpolar',
                                r: percentages,
                                theta: [...sdg_labels, sdg_labels[0]],
                                fill: 'toself',
                                fillcolor: colors[i],
                                name: course_labels[i],
                                line: {
                                    shape: 'spline',
                                    color: colors[i].replace(/[0-9.]+\)$/, '1.0)')
                                }
                            });
                        }
                    }

                    console.log("Final radar data:", radar_data);

                    const layout = {
                        polar: {
                            radialaxis: {
                                visible: true,
                                range: [0, 20],
                                tickvals: [0, 25, 50, 75, 100],
                                ticktext: ['0%', '25%', '50%', '75%', '100%'],
                                tickfont: { size: 12 },
                                gridcolor: 'lightgrey',
                                linecolor: 'grey'
                            },
                            angularaxis: {
                                tickfont: { size: 12 },
                                gridcolor: 'lightgrey',
                                linecolor: 'grey'
                            },
                            bgcolor: 'white'
                        },
                        showlegend: true,
                        legend: {
                            font: { size: 12, family: 'Arial, sans-serif' },
                            bgcolor: 'white',
                            bordercolor: 'white',
                            borderwidth: 0,
                            x: 1.1,
                            y: 1,
                            xanchor: 'left',
                            yanchor: 'top'
                        },
                        width: 1100,
                        height: 800
                    };

                    Plotly.newPlot('plot-container', radar_data, layout);

                } catch (error) {
                    console.error('Error loading or processing SDG data:', error);
                }
            }

            document.getElementById('heatmapNonCumBtn').addEventListener('click', function() {
                this.classList.add('active');
                document.getElementById('heatmapCumBtn').classList.remove('active');
                document.getElementById('radarBtn').classList.remove('active');
                document.getElementById('sankeyBtn').classList.remove('active');
                document.getElementById('sdgBtn').classList.remove('active');
                document.getElementById('sdgCumBtn').classList.remove('active');
                document.getElementById('sdgRadarBtn').classList.remove('active');
                createHeatmap(false);
            });

            document.getElementById('heatmapCumBtn').addEventListener('click', function() {
                this.classList.add('active');
                document.getElementById('heatmapNonCumBtn').classList.remove('active');
                document.getElementById('radarBtn').classList.remove('active');
                document.getElementById('sankeyBtn').classList.remove('active');
                document.getElementById('sdgBtn').classList.remove('active');
                document.getElementById('sdgCumBtn').classList.remove('active');
                document.getElementById('sdgRadarBtn').classList.remove('active');
                createHeatmap(true);
            });

            document.getElementById('radarBtn').addEventListener('click', function() {
                this.classList.add('active');
                document.getElementById('heatmapNonCumBtn').classList.remove('active');
                document.getElementById('heatmapCumBtn').classList.remove('active');
                document.getElementById('sankeyBtn').classList.remove('active');
                document.getElementById('sdgBtn').classList.remove('active');
                document.getElementById('sdgCumBtn').classList.remove('active');
                document.getElementById('sdgRadarBtn').classList.remove('active');
                createRadarPlot();
            });

            document.getElementById('sankeyBtn').addEventListener('click', function() {
                this.classList.add('active');
                document.getElementById('heatmapNonCumBtn').classList.remove('active');
                document.getElementById('heatmapCumBtn').classList.remove('active');
                document.getElementById('radarBtn').classList.remove('active');
                document.getElementById('sdgBtn').classList.remove('active');
                document.getElementById('sdgCumBtn').classList.remove('active');
                document.getElementById('sdgRadarBtn').classList.remove('active');
                createSankeyDiagram();
            });

            document.getElementById('sdgBtn').addEventListener('click', function() {
                this.classList.add('active');
                document.getElementById('heatmapNonCumBtn').classList.remove('active');
                document.getElementById('heatmapCumBtn').classList.remove('active');
                document.getElementById('radarBtn').classList.remove('active');
                document.getElementById('sankeyBtn').classList.remove('active');
                document.getElementById('sdgCumBtn').classList.remove('active');
                document.getElementById('sdgRadarBtn').classList.remove('active');
                createSdgHeatmap();
            });

            document.getElementById('sdgCumBtn').addEventListener('click', function() {
                this.classList.add('active');
                document.getElementById('heatmapNonCumBtn').classList.remove('active');
                document.getElementById('heatmapCumBtn').classList.remove('active');
                document.getElementById('radarBtn').classList.remove('active');
                document.getElementById('sankeyBtn').classList.remove('active');
                document.getElementById('sdgBtn').classList.remove('active');
                document.getElementById('sdgRadarBtn').classList.remove('active');
                createCumulativeSdgHeatmap();
            });

            document.getElementById('sdgRadarBtn').addEventListener('click', function() {
                this.classList.add('active');
                document.getElementById('heatmapNonCumBtn').classList.remove('active');
                document.getElementById('heatmapCumBtn').classList.remove('active');
                document.getElementById('radarBtn').classList.remove('active');
                document.getElementById('sankeyBtn').classList.remove('active');
                document.getElementById('sdgBtn').classList.remove('active');
                document.getElementById('sdgCumBtn').classList.remove('active');
                createSdgRadarPlot();
            });
</script>
</body>
</html>